"""Security headers check"""

from ..config import SECURITY_HEADERS

def check_security_headers(request_handler, target_url):
    """Check for missing security headers"""
    print(f"[*] Checking security headers: {target_url}")
    
    response = request_handler.get(target_url)
    if not response:
        return None
    
    headers = response.headers
    missing_headers = []
    
    for header, description in SECURITY_HEADERS.items():
        if header not in headers:
            missing_headers.append({
                'header': header,
                'description': description
            })
    
    if missing_headers:
        print(f"    [+] FOUND: {len(missing_headers)} missing security headers")
        return {
            'type': 'Missing Security Headers',
            'severity': 'LOW',
            'url': target_url,
            'missing_headers': missing_headers
        }
    
    return None