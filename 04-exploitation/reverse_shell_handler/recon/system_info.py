"""Gather basic system information"""

from ..config import SHELL_ID_COMMANDS

class SystemInfo:
    """Identify shell type and basic system information"""
    
    def __init__(self, communicator):
        self.communicator = communicator
    
    def check_shell_type(self):
        """Determine what type of shell we have"""
        print("[*] Identifying shell type...")
        
        # Check OS
        os_info = self.communicator.execute_command(SHELL_ID_COMMANDS['os'])
        if os_info:
            print(f"[+] OS Info:\n{os_info}")
        
        # Check user
        user = self.communicator.execute_command(SHELL_ID_COMMANDS['user'])
        if user:
            print(f"[+] User: {user.strip()}")
        
        # Check privileges
        id_info = self.communicator.execute_command(SHELL_ID_COMMANDS['id'])
        if id_info:
            print(f"[+] ID: {id_info.strip()}")
        
        # Check sudo
        sudo_info = self.communicator.execute_command(SHELL_ID_COMMANDS['sudo'])
        if sudo_info and 'may run' in sudo_info:
            print(f"[+] Sudo privileges: YES")
            print(f"{sudo_info}")
        else:
            print(f"[+] Sudo privileges: NO")
        
        # Check shell
        shell = self.communicator.execute_command(SHELL_ID_COMMANDS['shell'])
        if shell:
            print(f"[+] Shell: {shell.strip()}")