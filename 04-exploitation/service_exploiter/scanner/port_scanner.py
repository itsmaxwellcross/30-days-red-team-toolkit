"""Port scanning utilities"""

import socket
from ..config import COMMON_PORTS, PORT_SCAN_TIMEOUT

class PortScanner:
    """Scan for open ports on target"""
    
    def __init__(self, target):
        self.target = target
    
    def scan(self, ports=None):
        """
        Quick port scan for common services
        Returns: List of open ports
        """
        if ports is None:
            ports = COMMON_PORTS
        
        print(f"[*] Scanning {self.target} for open ports...")
        open_ports = []
        
        for port in ports:
            if self._is_port_open(port):
                print(f"    [+] Port {port} is open")
                open_ports.append(port)
        
        return open_ports
    
    def _is_port_open(self, port):
        """Check if a single port is open"""
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(PORT_SCAN_TIMEOUT)
        
        try:
            result = sock.connect_ex((self.target, port))
            return result == 0
        except:
            return False
        finally:
            sock.close()